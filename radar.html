<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MITRE ATT&CK Tactic Progress Bars for zhCat</title>
    <style>
        #attack-techniques-detail {
            width: 600px;
            padding: 10px;
        }

        .attack-technique {
            margin-bottom: 3px;
            line-height: 1.2;
        }

        .attack-progress {
            width: 55%;
            vertical-align: middle;
            margin-left: 5px;
            margin-right: 5px;
        }

        .attack-progress::-webkit-progress-bar {
            background-color: #eee;
        }

        .attack-technique-label {
            display: inline-block;
            width: 30%;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .attack-ratio {
            display: inline-block;
            width: 10%;
        }
    </style>
</head>

<body>

<div id="attack-techniques-detail"></div>

<script>
    var threatdata = {
    "name": "zhCat",
    "alias": "zhCat",
    "category": "Malware",
    "type": "Tunneling",
    "modified": "2020-05-14",
    "all_data": {
        "tool": "zhCat",
        "names": [
            {
                "name": "zhCat"
            }
        ],
        "description": "(Cylance) zhCat is a tool developed by the Operation Cleaver team which operates similarly to NetCat. Its main purpose is to create a channel that is capable of transporting information over the network. The changes made in zhCat allow for this information to be transferred with inline obfuscation and/or encryption. This makes it more difficult to detect that privileged information is being exfiltrated.",
        "category": "Malware",
        "type": [
            "Tunneling"
        ],
        "information": [
            "https://www.cylance.com/content/dam/cylance/pages/operation-cleaver/Cylance_Operation_Cleaver_Report.pdf"
        ],
        "malpedia": [
            "https://malpedia.caad.fkie.fraunhofer.de/details/win.zhcat"
        ],
        "uuid": "a3f17fa7-c340-412a-b10c-c4ab6a990622",
        "last-card-change": "2020-05-14",
        "source": "https://apt.etda.or.th/cgi-bin/listtools.cgi"
    },
    "ioc_data": [],
    "last_ioc_update": null,
    "mitre": [
        {
            "procedure_name": "at",
            "procedure_code": "s0110",
            "procedure_type": "software",
            "procedure_link": "https://attack.mitre.org/software/S0110",
            "techniques": [
                {
                    "tactic_code": "ta0002",
                    "tactic_link": "https://attack.mitre.org/tactics/TA0002",
                    "tactic_name": "execution",
                    "tactic_alias": "execution",
                    "tactic_description": "The adversary is trying to run malicious code.",
                    "technique_code": "t1053.002",
                    "technique_link": "https://attack.mitre.org/techniques/T1053/002",
                    "technique_name": "scheduled task/job : at",
                    "technique_description": "adversaries may abuse the at utility to perform task scheduling for initial or recurring execution of malicious code. the at utility exists as an executable within windows, linux, and macos for scheduling tasks at a specified time and date. although deprecated in favor of scheduled task's schtasks in windows environments, using at requires that the task scheduler service be running, and the user to be logged on as a member of the local administrators group.",
                    "procedure_description": "at can be used to schedule a task on a system to be executed at a specific date or time.[4][1]"
                },
                {
                    "tactic_code": "ta0003",
                    "tactic_link": "https://attack.mitre.org/tactics/TA0003",
                    "tactic_name": "persistence",
                    "tactic_alias": "persistence",
                    "tactic_description": "The adversary is trying to maintain their foothold.",
                    "technique_code": "t1053.002",
                    "technique_link": "https://attack.mitre.org/techniques/T1053/002",
                    "technique_name": "scheduled task/job : at",
                    "technique_description": "adversaries may abuse the at utility to perform task scheduling for initial or recurring execution of malicious code. the at utility exists as an executable within windows, linux, and macos for scheduling tasks at a specified time and date. although deprecated in favor of scheduled task's schtasks in windows environments, using at requires that the task scheduler service be running, and the user to be logged on as a member of the local administrators group.",
                    "procedure_description": "at can be used to schedule a task on a system to be executed at a specific date or time.[4][1]"
                },
                {
                    "tactic_code": "ta0004",
                    "tactic_link": "https://attack.mitre.org/tactics/TA0004",
                    "tactic_name": "privilege escalation",
                    "tactic_alias": "privilege_escalation",
                    "tactic_description": "The adversary is trying to gain higher-level permissions.",
                    "technique_code": "t1053.002",
                    "technique_link": "https://attack.mitre.org/techniques/T1053/002",
                    "technique_name": "scheduled task/job : at",
                    "technique_description": "adversaries may abuse the at utility to perform task scheduling for initial or recurring execution of malicious code. the at utility exists as an executable within windows, linux, and macos for scheduling tasks at a specified time and date. although deprecated in favor of scheduled task's schtasks in windows environments, using at requires that the task scheduler service be running, and the user to be logged on as a member of the local administrators group.",
                    "procedure_description": "at can be used to schedule a task on a system to be executed at a specific date or time.[4][1]"
                }
            ]
        }
    ],
    "file_name": "zhcat",
    "analysis": null,
    "articles": []
};

    const tacticsOverview = {
        "reconnaissance": 43,
        "resource development": 45,
        "initial access": 19,
        "execution": 36,
        "persistence": 113,
        "privilege escalation": 96,
        "defense evasion": 184,
        "credential access": 63,
        "discovery": 44,
        "lateral movement": 22,
        "collection": 37,
        "command and control": 39,
        "exfiltration": 18,
        "impact": 26
    };

    function countTechniquesForTactic(tacticCode) {
        return threatdata.mitre[0].techniques.filter(t => t.tactic_code === tacticCode).length;
    }

    function populateMitreAttackTechniquesDetail() {
        var detailDiv = document.getElementById('attack-techniques-detail');
        var detailsHtml = "";

        Object.keys(tacticsOverview).forEach(tacticName => {
            let tacticCode = "ta" + (Object.keys(tacticsOverview).indexOf(tacticName) + 1).toString().padStart(4, '0');
            let count = countTechniquesForTactic(tacticCode);
            detailsHtml += `
                <div class="attack-technique">
                    <span class="attack-technique-label">${tacticName}</span>
                    <progress class="attack-progress" value="${count}" max="${tacticsOverview[tacticName]}"></progress>
                    <span class="attack-ratio">${count}/${tacticsOverview[tacticName]}</span>
                </div>
            `;
        });

        detailDiv.innerHTML = detailsHtml;
    }

    populateMitreAttackTechniquesDetail();
</script>

</body>
</html>
