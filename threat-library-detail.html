<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Open Hunting - Threat Library</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="Free HTML Templates" name="keywords">
    <meta content="Free HTML Templates" name="description">

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet"> 

    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">

    <!-- Libraries Stylesheet -->
    <link href="assets/dp/lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">

   

    <!-- Favicon -->
    <link rel="shortcut icon" type="image/jpg" href="assets/lp/img/logo.png"/>
    
    <!-- external -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/styles/default.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/highlight.min.js"></script>

    <script src="https://d3js.org/d3.v7.min.js"></script>

     <!-- Customized Bootstrap Stylesheet -->
     <link href="assets/dp/css/style.css" rel="stylesheet">
     

</head>

<body>
    

    <!-- content-wrapper -->
    <div class="content-wrapper">
        <header>
            <nav class="navbar navbar-expand-lg navbar-light bg-white sticky" data-offset="500">
            <div class="container">
                <img src="assets/lp/img/logo.png" width="50px"><a href="#" class="navbar-brand" style="color: #ff5757;"><span class="text-primary">OPENHUNTING.IO</span></a>
        
                <button class="navbar-toggler" data-toggle="collapse" data-target="#navbarContent" aria-controls="navbarContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
                </button>
        
                <div class="navbar-collapse collapse" id="navbarContent">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                    <a class="nav-link" href="index">Home</a>
                    </li>
                    <li class="nav-item active">
                    <a class="nav-link" style="color: #ff5757;" href="threat-library">Threat Library</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="architecture">Architecture</a>
                    </li>
                    <li class="nav-item">
                    <a class="nav-link" href="whois">Whois</a>
                    </li>
                    
                    <li class="nav-item">
                        <a class="nav-link" href="https://github.com/openhunting-io">Github</a>
                    </li>
        
                </ul>
                </div>
        
            </div>
            </nav>

        </header>
        <!-- Shop Start -->
        <div class="container-fluid pt-5">
            <!-- The overlay -->
            
            
            <div class="row px-xl-5">
                <div class="col-lg-12 col-md-12" style="margin-bottom: 20px;">
                    <div class="customPage">
                        <center><a href="threat-library" style="color: #ff5757;">Openhunting Threat Library</a></center>
                        <div id="customSearchContainer" style="text-align: center; margin-top: 10px; margin-bottom: 20px;">
                            <input type="text" id="customSearchBox" placeholder="Search..." style="width: 60%; padding: 10px; border-radius: 20px; border: 1px solid #ccc;"><br>
                            <ul id="suggestionList" style="display: none; width: 60%; margin: 0 auto; list-style-type: none; padding: 0;"></ul>
                        </div>   
                    </div>
                </div>
                
                <div class="col-lg-12 col-md-12">
                    <div id="loader"></div>
                    <div class="container-fluid" id="threatdatapage" style="display: none;">
                        <div class="row">
                            <div class="col-lg-9">
                                <div class="row px-xl-5">
                                    <div class="col-lg-12 pb-5">
                                        <h3 class="font-weight-semi-bold" id="threatdataName"></h3>
                                        <div class="d-flex mb-3">
                                            <span class="text-dark font-weight-medium mb-0 mr-3" id="infoAlias" ></span>
                                        </div>
                                        <div class="d-flex mb-3">
                                            <span id="informationType" style="color:black;font-size: 0.8rem;"></span>
                                        </div>
                                        <div class="d-flex mb-3">
                                            <p class="mb-4" id="informationDescription" style="text-align: justify;"></p>
                                        </div>
                                    </div>
                                </div>
                                
                            </div>
                            <div class="col-lg-3 py-5">
                                <div class="mb-4 pb-4">
                                    <h5 class="font-weight-semi-bold mb-4" style="text-align: center;">Detection</h5>
                                    <button type="button" class="btn btn-primary fullWidthButton" style="width: 100%; color: white;" data-toggle="modal" data-target="#codeModal"><i class="fa fa-eye mr-1"></i> Hunting Template</button>
                                </div>   
                            </div>
                        </div>
                        <div class="row px-xl-5">
                            
                            <div class="col-lg-12">
                                <h3>[Analysis News] Trends:</h3>
                                <div class="citation-chart"></div>
                            </div>
                                <!--  -->
                        </div><br><br><br>
                        <div class="row px-xl-5">
                            <h3>[Analysis News] Related Category to Other Threat:</h3>
                            <div class="col-lg-12">
                                <!-- <svg width="800" height="600"></svg> -->
                                <svg id="graphSvg" style="border: 2px solid black;" width="90%" height="600" viewBox="0 0 [naturalWidth] [naturalHeight]" preserveAspectRatio="xMidYMid meet"></svg>
                            </div>
                        </div>
                        <br><br>

                        <div class="row px-xl-5 py-5" >
                            <h3>References:</h3>
                            <div class="col">
                                <div class="nav nav-tabs justify-content-center border-secondary mb-4">
                                    <a class="nav-item nav-link active" data-toggle="tab" href="#tab-pane-1">News</a>
                                    <a class="nav-item nav-link" data-toggle="tab" href="#tab-pane-2">Indicator of Compromise</a>
                                    <a class="nav-item nav-link" data-toggle="tab" href="#tab-pane-3">Mitre</a>
                                </div>
                                <div class="tab-content">
                                    <div class="tab-pane fade show active" id="tab-pane-1">
                                        <h4 class="mb-3" id="title_newsarticle"></h4>
                                        <!-- Container for the list of articles -->
                                        <div id="articlesContainer"></div>
                                    </div>
                                    <div class="tab-pane fade" id="tab-pane-2">
                                        <h4 class="mb-3" id="title_ioc"></h4>
                                        <!-- Container for the list of articles -->
                                        <div id="iocContainer"></div>
                                    </div>
                                    <div class="tab-pane fade" id="tab-pane-3">
                                        <h4 class="mb-3" id="title_mitre"></h4>
                                        <!-- Container for the list of articles -->
                                        <div id="mitreContainer"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
        <!-- Shop End -->
    </div>

<!-- Modal -->
<!-- Modal -->
<div class="modal fade" id="codeModal" tabindex="-1" aria-labelledby="codeModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="detectionTitle"></h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body modal-fullheight">
          <pre><code id="codeArea" class="yaml" contenteditable="false">
id: a317f7b4
info:
    name: ' X-Files Stealer Malware Rule'
    author: AndreGironda
    date: '2022-08-02 16:52:11'
    modified: Not Available
    severity: Critical
    category: botnet_cc
    description: null
    tags:
    - XfilesStealer
    - win.xfilesstealer
    references:
    - https://bazaar.abuse.ch/sample/bb6e3bb232cdd16773464d14e3f6ba292f9e2031c9b2eb46cfe86dfb352989e5/
    reporter: AndreGironda
    confidence_level: 100
method:
- query: select * from process_open_sockets
    column_master: remote_address
    signature:
    - name: domain
    indicator:
    - 185.225.73.217
    - 185.225.73.216
            
          </code></pre>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary" style="color: white;" onclick="copyCode()">Copy Template</button>
        </div>
      </div>
    </div>
  </div>


<!--  -->
    <footer class="page-footer" style="background: #ff5757;">
        <div class="container" style="background: #ff5757; max-height: 50px;">
          <p class="text-center" id="copyright" style="color: white;">Copyright &copy; 2023. Openhunting.io - Threat Library</p>
        </div>
      </footer>

    <!-- Back to Top -->
    <!-- <a href="#" class="btn btn-primary back-to-top"><i class="fa fa-angle-double-up"></i></a> -->


    <!-- JavaScript Libraries -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
    <script src="assets/dp/lib/easing/easing.min.js"></script>
    <script src="assets/dp/lib/owlcarousel/owl.carousel.min.js"></script>

    <!-- Contact Javascript File -->
    <script src="assets/dp/mail/jqBootstrapValidation.min.js"></script>
    <script src="assets/dp/mail/contact.js"></script>
    <script src="searchbox.js"></script>

    <script>
        // This function will extract the 'data' parameter from the URL
        function getURLParameter(name) {
            return decodeURIComponent((new RegExp('[?|&]' + name + '=' + '([^&;]+?)(&|#|;|$)').exec(location.search)||[,""])[1].replace(/\+/g, '%20')) || null;
        }
        // Fetch the 'data' parameter
        var dataFile = getURLParameter('data');
        // console.log(dataFile)
        // If there's a 'data' parameter, dynamically load the related JS file
        if(dataFile) {
            var script = document.createElement('script');
            script.src = 'threat/'+dataFile + '.js'; // Assuming the JS file has the same name as the data parameter value
            script.onload = function() {
                var nameThreat = threatdata['name'];
                var aliasThreat = threatdata['alias'];
                var typeThreat = threatdata['type'];
                var descriptionThreat = threatdata['all_data']['description']

                var threatdataName_text = document.getElementById('threatdataName');
                threatdataName_text.textContent = nameThreat;

                var detectionTitle_text = document.getElementById('detectionTitle');
                detectionTitle_text.textContent = "Detection: "+nameThreat;

                var infoAlias_text = document.getElementById('infoAlias');
                infoAlias_text.textContent = aliasThreat;

                var informationType_text = document.getElementById('informationType');
                informationType_text.textContent = "(Type: "+typeThreat+")";

                // informationDescription
                var informationDescription_text = document.getElementById('informationDescription');
                informationDescription_text.textContent = descriptionThreat;
            
                // Articles Tab
                const articlesContainer = document.getElementById('articlesContainer');

                if (threatdata && threatdata['articles'] && threatdata['articles'].length > 0) {
                    var title_newsarticle = document.getElementById('title_newsarticle');
                    title_newsarticle.innerHTML = 'News Article (Credit @<a href="https://malpedia.caad.fkie.fraunhofer.de/">Malpedia</a>)';
                }

                // Iterate through each article in the threatdata['articles'] array
                threatdata['articles'].forEach(article => {
                    // Create a new div for the article
                    const articleDiv = document.createElement('div');
                    articleDiv.classList.add('single-article');  // Optional: add a class for styling

                    // Add the title with a link
                    const articleTitle = document.createElement('a');
                    articleTitle.href = article.data_url;
                    articleTitle.innerText = article.title;
                    articleTitle.target = "_blank";  // Open in new tab

                    // Add the date, organization, and author
                    const articleInfo = document.createElement('p');
                    articleInfo.innerText = `${article.date} by ${article.author} from ${article.organization}`;

                    // Append the title and info to the articleDiv
                    articleDiv.appendChild(articleTitle);
                    articleDiv.appendChild(articleInfo);

                    // Append the articleDiv to the articlesContainer
                    articlesContainer.appendChild(articleDiv);
                });

            //Iterate though each IOC
            if(threatdata['ioc_data'] && threatdata['ioc_data'].length > 0) {
                var title_ioc = document.getElementById('title_ioc');
                title_ioc.innerHTML = 'Indicators of Compromise (Credit @<a href="https://threatfox.abuse.ch">ThreatFox</a>)';

                var iocContainer = document.getElementById('iocContainer');
                
                // Create a dictionary to organize the IOCs by their types
                var categorizedIOCs = {};
                threatdata['ioc_data'].forEach(data => {
                    for (var type in data.ioc) {
                        if (!categorizedIOCs[type]) {
                            categorizedIOCs[type] = [];
                        }
                        data.ioc[type].forEach(iocDetail => {
                            categorizedIOCs[type].push(iocDetail.value);
                        });
                    }
                });

                // Display each category of IOC
                for (var type in categorizedIOCs) {
                    var typeHeader = document.createElement('h5');
                    typeHeader.innerHTML = type.toUpperCase();
                    iocContainer.appendChild(typeHeader);

                    var iocList = document.createElement('ul');
                    categorizedIOCs[type].forEach(iocValue => {
                        var iocItem = document.createElement('li');
                        iocItem.innerHTML = iocValue;
                        iocList.appendChild(iocItem);
                    });
                    iocContainer.appendChild(iocList);
                }
            }

            // Iterate Trough Mitre
            if(threatdata['mitre'] && threatdata['mitre'].length > 0) {
                var title_mitre = document.getElementById('title_mitre');
                title_mitre.innerHTML = 'MITRE Techniques (Credit @<a href="https://attack.mitre.org/">Mitre</a>)';

                var mitreContainer = document.getElementById('mitreContainer');

                threatdata['mitre'].forEach(mitreEntry => {
                    mitreEntry['techniques'].forEach(technique => {
                        // Create a header with the technique link, code, and name
                        var techniqueHeader = document.createElement('p');
                        techniqueHeader.className = "technique-title";
                        
                        var techniqueLink = document.createElement('a');
                        techniqueLink.href = technique['technique_link'];
                        techniqueLink.innerText = '[' + technique['technique_code'] + '] ' + technique['technique_name'];
                        techniqueHeader.appendChild(techniqueLink);
                        mitreContainer.appendChild(techniqueHeader);

                        // Add the procedure description and the details link
                        var procedureDesc = document.createElement('p');
                        procedureDesc.className = "procedure-description";
                        procedureDesc.innerText = technique['procedure_description'].replace(/\[\d+\]/g, "");

                        var detailsLink = document.createElement('a');
                        detailsLink.href = "#"; // Link to the source or just use '#' to do nothing on click
                        detailsLink.className = "details-link";
                        detailsLink.innerText = "[details]";
                        detailsLink.addEventListener('click', function(e) {
                            e.preventDefault(); // Prevent default action
                            if (techniqueDesc.style.display === "none") {
                                techniqueDesc.style.display = "block";
                            } else {
                                techniqueDesc.style.display = "none";
                            }
                        });

                        procedureDesc.appendChild(detailsLink);
                        mitreContainer.appendChild(procedureDesc);

                        // Add the technique description (initially hidden)
                        var techniqueDesc = document.createElement('p');
                        techniqueDesc.className = "technique-description";
                        techniqueDesc.innerText = technique['technique_description'];
                        techniqueDesc.style.display = "none";
                        mitreContainer.appendChild(techniqueDesc);
                    });
                });
            }

            // Bar Chart
            const rawData = threatdata['articles'];

            // console.log(rawData)
            function formatDate(dateString) {
                const months = [
                    "Jan", "Feb", "Mar", "Apr", "May", "Jun",
                    "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"
                ];
                
                // Check if the dateString contains a '-'. If not, return the year directly.
                if (!dateString.includes('-')) {
                    return dateString;
                }

                const [year, month] = dateString.split('-');
                return `${months[parseInt(month) - 1]} ${year}`;
            }


            const dataMap = rawData.reduce((acc, item) => {
                const monthYear = item.date.slice(0, 7);
                if (!acc[monthYear]) {
                    acc[monthYear] = 1;
                } else {
                    acc[monthYear]++;
                }
                return acc;
            }, {});

            const data = Object.keys(dataMap).sort().map(monthYear => {
                return { date: monthYear, count: dataMap[monthYear] };
            });

            const maxCount = Math.max(...data.map(item => item.count));
            const chartDiv = document.querySelector('.citation-chart');

            data.forEach(item => {
                const barContainerDiv = document.createElement('div');
                barContainerDiv.className = 'citation-bar-container';
                const labelDiv = document.createElement('div');

                

                const countLabelDiv = document.createElement('div');
                countLabelDiv.className = 'citation-count-label';
                countLabelDiv.textContent = item.count;

                const barDiv = document.createElement('div');
                barDiv.className = 'citation-bar';
                const normalizedHeight = (item.count / maxCount) * 200;
                barDiv.style.height = `${normalizedHeight}px`;
                barDiv.title = `${item.date}: ${item.count} citations`;

                labelDiv.className = 'citation-label';
                labelDiv.textContent = formatDate(item.date);

                // Check the length of the date text and adjust the style if necessary
                if (labelDiv.textContent.length <= 4) { // i.e., it's just a year
                    labelDiv.style.fontSize = "9px";
                    labelDiv.style.marginLeft = "-20px"; // Adjust the margin
                    // Add more style adjustments if needed
                }

                barContainerDiv.appendChild(countLabelDiv);
                barContainerDiv.appendChild(barDiv);
                barContainerDiv.appendChild(labelDiv);
                chartDiv.appendChild(barContainerDiv);
            });


            /////////////////////////////////////////
            /////////START NETWORK GRAPH/////////////
            /////////////////////////////////////////
            function transformDataToGraph(threatdata) {
                let nodes = [];
                let links = [];
                let allCategories = new Set(); // For checking unique categories across all articles
                let nodeDegree = {}; // For tracking the degree of nodes

                threatdata.articles.forEach(article => {
                    let uniqueCategories = [...new Set(article.categories)]; // Remove duplicates within a single article

                    // Extract categories and form links
                    for (let i = 0; i < uniqueCategories.length; i++) {
                        for (let j = i + 1; j < uniqueCategories.length; j++) {
                            let linkExists = links.some(link => 
                                (link.source === uniqueCategories[i] && link.target === uniqueCategories[j]) || 
                                (link.source === uniqueCategories[j] && link.target === uniqueCategories[i])
                            );

                            if (!linkExists) {
                                links.push({
                                    source: uniqueCategories[i],
                                    target: uniqueCategories[j]
                                });

                                // Count the degree for nodes
                                nodeDegree[uniqueCategories[i]] = (nodeDegree[uniqueCategories[i]] || 0) + 1;
                                nodeDegree[uniqueCategories[j]] = (nodeDegree[uniqueCategories[j]] || 0) + 1;
                            }
                        }
                        allCategories.add(uniqueCategories[i]);
                    }
                });

                let maxDegree = Math.max(...Object.values(nodeDegree));
                let minDegree = Math.min(...Object.values(nodeDegree));

                // Function to normalize the degree to determine node size
                function normalizeSize(degree) {
                    let normalized = (degree - minDegree) / (maxDegree - minDegree);
                    return 10 + normalized * 20; // this will give a size between 10 and 30 based on the node degree
                }

                // Extract nodes
                [...allCategories].forEach(category => {
                    nodes.push({
                        id: category,
                        degree: nodeDegree[category] || 0,
                        normalizedSize: normalizeSize(nodeDegree[category] || 0)
                    });
                });

                return {
                    nodes: nodes,
                    links: links
                };
            }


            var graphData = transformDataToGraph(threatdata);

            // 1. Sort the nodes by their degree.
            const sortedNodes = [...graphData.nodes].sort((a, b) => b.degree - a.degree);

            // 2. Take the top N nodes (in this case, 3).
            const topNodes = sortedNodes.slice(0, 10);

            // 3. Include any additional nodes that have the same degree as the Nth node.
            const thresholdDegree = topNodes[topNodes.length - 1].degree;
            const extraNodes = sortedNodes.slice(3).filter(node => node.degree === thresholdDegree);

            // Combine the two arrays to get the final list of top nodes.
            const finalTopNodes = [...topNodes, ...extraNodes].map(node => node.id);


            const svg = d3.select("svg");
            // const width = +svg.attr("width");
            const width = +svg.node().getBoundingClientRect().width;

            const height = +svg.attr("height");

            const container = svg.append("g");

            const zoom = d3.zoom()
                .scaleExtent([0.1, 5]) 
                .on("zoom", zoomed);

            svg.call(zoom);

            function zoomed(event) {
                container.attr("transform", event.transform);
            }

            const simulation = d3.forceSimulation()
                .force("link", d3.forceLink().id(d => d.id).distance(150))
                .force("charge", d3.forceManyBody().strength(-800))
                .force("center", d3.forceCenter(width / 2, height / 2));

            const link = container.append("g")
                .selectAll("line")
                .data(graphData.links)
                .enter().append("line")
                .attr("class", "d3graph-link");

            const nodeGroup = container.append("g")
                .selectAll(".d3graph-nodeGroup")
                .data(graphData.nodes)
                .enter().append("g")
                .attr("class", "d3graph-nodeGroup")
                .call(d3.drag()
                    .on("start", dragstarted)
                    .on("drag", dragged)
                    .on("end", dragended));

            nodeGroup.append("circle")
                .attr("class", "d3graph-node")
                .attr("r", d => d.normalizedSize); 

            nodeGroup.append("text")
                .attr("class", "d3graph-text")
                .text(d => `${d.degree} - ${d.id}`)
                .attr("dx", 12)
                .attr("dy", 4);

            simulation
                .nodes(graphData.nodes)
                .on("tick", ticked);

            simulation.force("link")
                .links(graphData.links);

            function ticked() {
                link
                    .attr("x1", d => d.source.x)
                    .attr("y1", d => d.source.y)
                    .attr("x2", d => d.target.x)
                    .attr("y2", d => d.target.y);

                nodeGroup
                    .attr("transform", d => `translate(${d.x}, ${d.y})`);

                nodeGroup.select("circle")
                    .style("fill", d => finalTopNodes.includes(d.id) ? "red" : "#333");  // change 'red' to the desired color for top nodes
            }

            function dragstarted(event, d) {
                if (!event.active) simulation.alphaTarget(0.3).restart();
                d.fx = d.x;
                d.fy = d.y;
            }

            function dragged(event, d) {
                d.fx = event.x;
                d.fy = event.y;
            }

            function dragended(event, d) {
                if (!event.active) simulation.alphaTarget(0);
                d.fx = null;
                d.fy = null;
            }


            //////////////////////////////////////////
            //////////END NETWORK GRAPH///////////////
            //////////////////////////////////////////


            // Remove loading
            document.getElementById('loader').style.display = 'none';
            document.getElementById('threatdatapage').style.display = '';

            };
            document.body.appendChild(script);
           
        } else{
            window.location.href = "threat-library.html";
        }
        
    </script>

    <!-- Template Javascript -->
    <!-- <script src="assets/dp/js/main.js"></script> -->
    <script src="assets/lp/vendor/wow/wow.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', (event) => {
            hljs.highlightBlock(document.getElementById('codeArea'));
        });

        function copyCode() {
            let range = document.createRange();
            range.selectNode(document.getElementById('codeArea'));
            window.getSelection().removeAllRanges();
            window.getSelection().addRange(range);
            document.execCommand("copy");
            window.getSelection().removeAllRanges();
            // alert("Code copied to clipboard!");
        }

        const searchBox = document.getElementById("customSearchBox");
        const suggestionList = document.getElementById("suggestionList");

        searchBox.addEventListener('input', function() {
            const query = searchBox.value;
            
            if (query.length > 0) {
                populateSuggestions(query);
            } else {
                suggestionList.style.display = "none";
            }
        });
        function populateSuggestions(query) {
            const lowerCaseQuery = query.toLowerCase();
            
            const filteredSuggestions = suggestions.filter(suggestion => 
                suggestion.text.toLowerCase().includes(lowerCaseQuery)
            ).slice(0, 5);

            suggestionList.innerHTML = ''; // Clear current suggestions

            filteredSuggestions.forEach(suggestion => {
                const li = document.createElement("li");
                const a = document.createElement("a");
                a.href = suggestion.url;
                a.innerText = suggestion.text;
                a.style.textDecoration = "none"; // remove the underline from the link
                a.style.color = "inherit"; // use the inherited color for the link
                a.style.display = "block"; // make the link occupy the full space of the li
                a.style.padding = "8px"; // Move the padding from li to a for full row clickable

                li.appendChild(a);
                suggestionList.appendChild(li);
            });

            suggestionList.style.display = filteredSuggestions.length > 0 ? "block" : "none";
        }





    </script>
</body>

</html>